<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SoftCo AI Match — Intelligence Network</title>
<style>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');</style>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #0a0a0a;
    --bg2: #171717;
    --text: #fafafa;
    --muted: #a0a0a0;
    --accent: #047fe4;
    --softco: #047fe4;
    --orange: #f6921e;
  }

  body {
    background: #494949;
    color: var(--text);
    font-family: 'Inter', ui-sans-serif, system-ui, sans-serif;
    overflow: hidden;
    width: 100vw;
    height: 100vh;
    cursor: default;
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #canvas-box {
    position: relative;
    width: min(1264px, 100vw);
    height: 100vh;
    flex-shrink: 0;
  }

  /* Header */
  #header {
    position: absolute;
    top: 0; left: 0; right: 0;
    padding: 32px 40px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    z-index: 100;
    pointer-events: none;
  }
  #header h1 {
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.25em;
    text-transform: uppercase;
    color: var(--softco);
    margin-bottom: 12px;
  }
  #header .tagline {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  #header .tagline span {
    display: block;
    font-family: 'Inter', ui-sans-serif, system-ui, sans-serif;
    font-size: 22px;
    font-weight: 700;
    line-height: 1.25;
    color: #ffffff;
    letter-spacing: -0.02em;
  }
  #header .tagline span.dim {
    color: rgba(255,255,255,0.45);
    font-weight: 400;
  }

  /* Legend */
  #legend {
    position: absolute;
    bottom: 32px;
    left: 40px;
    z-index: 100;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .legend-item {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: ui-monospace, 'Courier New', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 0.08em;
  }
  .legend-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  /* Tooltip */
  #tooltip {
    position: fixed;
    background: rgba(255, 255, 255, 0.10);
    border: 1px solid rgba(255, 255, 255, 0.25);
    border-radius: 6px;
    padding: 10px 14px;
    font-family: ui-monospace, 'Courier New', monospace;
    font-size: 11px;
    line-height: 1.6;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.15s;
    z-index: 200;
    max-width: 260px;
    backdrop-filter: blur(12px);
  }
  #tooltip .tt-layer {
    color: #ffffff;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.18em;
    text-transform: uppercase;
    margin-bottom: 4px;
    opacity: 0.75;
  }
  #tooltip .tt-name {
    color: #ffffff;
    font-size: 13px;
    font-family: 'Inter', ui-sans-serif, system-ui, sans-serif;
    font-weight: 600;
  }

  /* Counter */
  #counter {
    position: absolute;
    top: 32px;
    right: 40px;
    text-align: right;
    font-family: ui-monospace, 'Courier New', monospace;
    font-size: 11px;
    color: var(--muted);
    letter-spacing: 0.05em;
    line-height: 1.8;
  }
  #counter span {
    color: var(--text);
    font-weight: 400;
  }

  canvas { display: block; }

  /* Pulse ring animation */
  @keyframes pulse-ring {
    0%   { r: 0; opacity: 0.6; }
    100% { r: 80; opacity: 0; }
  }
</style>
</head>
<body>

<div id="canvas-box">

<div id="header">
  <div>
    <h1>SoftCo AI Match</h1>
    <div class="tagline">
      <span>Every invoice.</span>
      <span class="dim">Every match.</span>
      <span class="dim">Always learning.</span>
    </div>
  </div>
</div>

<div id="counter">
  <div>Match Patterns <span id="cnt-patterns">0</span></div>
  <div>Suppliers <span id="cnt-suppliers">0</span></div>
  <div>Organisations <span id="cnt-orgs">0</span></div>
  <div>Customers <span id="cnt-customers">0</span></div>
</div>

<div id="legend">
  <div class="legend-item"><div class="legend-dot" style="background:#ffffff;box-shadow:0 0 6px rgba(255,255,255,0.6)"></div>Match Pattern</div>
  <div class="legend-item"><div class="legend-dot" style="background:#047fe4;box-shadow:0 0 6px rgba(4,127,228,0.7)"></div>Supplier</div>
  <div class="legend-item"><div class="legend-dot" style="background:#f6921e;box-shadow:0 0 6px rgba(246,146,30,0.7)"></div>Organisation</div>
  <div class="legend-item"><div class="legend-dot" style="background:#92c5fe;box-shadow:0 0 6px rgba(146,197,254,0.7)"></div>Customer</div>
</div>

<div id="tooltip">
  <div class="tt-layer" id="tt-layer"></div>
  <div class="tt-name" id="tt-name"></div>
</div>

<canvas id="canvas"></canvas>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
// ── Data ─────────────────────────────────────────────────────────────────────
const PATTERNS = [
  // Core matching
  'Exact PO Line Match','2-Way Header Match','3-Way Match with GRN',
  'Confidence-Based Auto-Match','Aggregate Line Matching',
  // Tolerance & variance
  'FX & Currency Tolerance Match','Rounding Variance Match',
  'Unit Price Tolerance Match','Quantity Variance Match',
  'Exchange Rate Adjustment Match',
  // Delivery & fulfilment
  'Partial Delivery Match','Recurring / Subscription Match',
  'Partial Delivery (Multi-GRN)','Split Invoice Match',
  'Blanket PO Match',
  // Non-PO & coding
  'Non-PO Smart Coding Match','Non-PO Routing Match',
  'Smart GL Coding Match','Cost Centre Auto-Assignment',
  // Surcharges & exceptions
  'Surcharge & Freight Match','Duty & Tax Surcharge Match',
  'Environmental Levy Match','Fuel Surcharge Match',
  // Recovery & incomplete data
  'Missing Product Code Match','Incomplete Data Recovery Match',
  'Incomplete Header Recovery','Description-Only Match',
  // Advanced & cross-entity
  'Multi-Entity / Cross-Org Match','Intercompany Match',
  'Contract PO Match','Prepayment Reconciliation Match',
  // Risk & compliance
  'Fraud-Flag Override Match','Exception Resolution Match',
];

const CUSTOMERS = [
  {name:'Vantara Manufacturing',     industry:'Manufacturing',         color:'#047fe4', orgs:3, suppliers:10},
  {name:'Skybridge Aviation',        industry:'Aviation & Aerospace',  color:'#f6921e', orgs:2, suppliers:8},
  {name:'NordRetail Group',          industry:'Retail & E-Commerce',   color:'#92c5fe', orgs:3, suppliers:12},
  {name:'Meridian Financial',        industry:'Financial Services',    color:'#047fe4', orgs:2, suppliers:7},
  {name:'Harrow Foods',              industry:'Food & Beverage',       color:'#f6921e', orgs:2, suppliers:8},
  {name:'Celeron Pharma',            industry:'Healthcare & Pharma',   color:'#92c5fe', orgs:2, suppliers:6},
  {name:'TranzLog Europe',           industry:'Logistics & Transport', color:'#047fe4', orgs:3, suppliers:9},
  {name:'ArcLight Energy',           industry:'Energy & Utilities',    color:'#f6921e', orgs:2, suppliers:7},
  {name:'Ironclad Precision Tools',  industry:'Manufacturing',         color:'#92c5fe', orgs:2, suppliers:8},
  {name:'HorizonAir Cargo',          industry:'Aviation & Aerospace',  color:'#047fe4', orgs:3, suppliers:10},
  {name:'Belmont Retail Holdings',   industry:'Retail & E-Commerce',   color:'#f6921e', orgs:2, suppliers:9},
  {name:'Citadel Capital Partners',  industry:'Financial Services',    color:'#92c5fe', orgs:2, suppliers:6},
  {name:'Clearwater Beverages',      industry:'Food & Beverage',       color:'#047fe4', orgs:2, suppliers:7},
  {name:'MedCore Solutions',         industry:'Healthcare & Pharma',   color:'#f6921e', orgs:2, suppliers:5},
  {name:'FastFreight Logistics',     industry:'Logistics & Transport', color:'#92c5fe', orgs:2, suppliers:9},
  {name:'SolarGrid Utilities',       industry:'Energy & Utilities',    color:'#047fe4', orgs:2, suppliers:6},
  {name:'Apex Fabrication Group',    industry:'Manufacturing',         color:'#f6921e', orgs:3, suppliers:13},
  {name:'GlobalWings Airlines',      industry:'Aviation & Aerospace',  color:'#92c5fe', orgs:2, suppliers:8},
  {name:'UrbanMart Retail',          industry:'Retail & E-Commerce',   color:'#047fe4', orgs:3, suppliers:11},
  {name:'Pinnacle Asset Finance',    industry:'Financial Services',    color:'#f6921e', orgs:2, suppliers:7},
];

const GEO = ['EMEA','North America','Asia Pacific','Latin America'];
const SUPPLIER_PREFIXES = ['SUPP','VND','SPLR','SVC'];

// ── Seeded random ─────────────────────────────────────────────────────────────
let seed = 42;
function rand() {
  seed = (seed * 1664525 + 1013904223) & 0xffffffff;
  return (seed >>> 0) / 0xffffffff;
}
function randInt(a, b) { return Math.floor(rand() * (b - a + 1)) + a; }
function randItem(arr) { return arr[Math.floor(rand() * arr.length)]; }
function randSample(arr, n) {
  const a = [...arr]; for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(rand() * (i + 1)); [a[i], a[j]] = [a[j], a[i]];
  }
  return a.slice(0, n);
}

// ── Build node/edge data ──────────────────────────────────────────────────────
const nodes = [];
const edges = [];

const box = document.getElementById('canvas-box');
const W = box.offsetWidth, H = box.offsetHeight;
const cx = W / 2 + 80, cy = H / 2;
const minDim = Math.min(W, H);
const R = [0, minDim * 0.16, minDim * 0.3, minDim * 0.44];

// Pattern nodes — centre cluster
const patternNodes = PATTERNS.map((name, i) => {
  const angle = (2 * Math.PI * i) / PATTERNS.length;
  const r = R[0] + 45 + (i % 4) * 22;
  return {
    id: `pat-${i}`, name, layer: 'Match Pattern',
    color: '#ffffff',
    x: cx + r * Math.cos(angle),
    y: cy + r * Math.sin(angle),
    radius: 5, baseRadius: 5, alpha: 0, targetAlpha: 1,
    vx: 0, vy: 0,
  };
});
nodes.push(...patternNodes);

// Customer / Org / Supplier nodes
let orgIndex = 0, supIndex = 0;
let totalOrgs = 0, totalSuppliers = 0;
CUSTOMERS.forEach(c => { totalOrgs += c.orgs; totalSuppliers += c.orgs * c.suppliers; });

CUSTOMERS.forEach((cust, ci) => {
  const custAngle = (2 * Math.PI * ci) / CUSTOMERS.length;
  const custR = R[3] + randInt(-20, 20);
  const custNode = {
    id: `cust-${ci}`, name: cust.name, layer: 'Customer',
    industry: cust.industry, color: cust.color,
    x: cx + custR * Math.cos(custAngle),
    y: cy + custR * Math.sin(custAngle),
    radius: 7, baseRadius: 7, alpha: 0, targetAlpha: 1,
    vx: 0, vy: 0,
  };
  nodes.push(custNode);

  const geos = GEO.slice(0, cust.orgs);
  geos.forEach((geo, gi) => {
    const orgAngle = custAngle + (gi - (cust.orgs - 1) / 2) * 0.18;
    const orgR = R[2] + randInt(-25, 25);
    const orgNode = {
      id: `org-${orgIndex}`, name: `${cust.name} — ${geo}`, layer: 'Organisation',
      color: '#f6921e',
      x: cx + orgR * Math.cos(orgAngle),
      y: cy + orgR * Math.sin(orgAngle),
      radius: 5, baseRadius: 5, alpha: 0, targetAlpha: 1,
      vx: 0, vy: 0,
    };
    nodes.push(orgNode);
    edges.push({ from: orgNode.id, to: custNode.id, color: '#f6921e' });

    const patSubset = randSample(patternNodes.map(p => p.id), Math.min(10, PATTERNS.length));
    const supCount = cust.suppliers;
    for (let si = 0; si < supCount; si++) {
      const supAngle = orgAngle + (si - (supCount - 1) / 2) * 0.08;
      const supR = R[1] + randInt(-20, 20);
      const supName = `${randItem(SUPPLIER_PREFIXES)}${randInt(100,9999)}`;
      const supNode = {
        id: `sup-${supIndex}`, name: `Supplier ${supName}`, layer: 'Supplier',
        color: '#047fe4',
        x: cx + supR * Math.cos(supAngle),
        y: cy + supR * Math.sin(supAngle),
        radius: 3, baseRadius: 3, alpha: 0, targetAlpha: 1,
        vx: 0, vy: 0,
      };
      nodes.push(supNode);
      edges.push({ from: supNode.id, to: orgNode.id, color: '#047fe4' });
      randSample(patSubset, randInt(2, 5)).forEach(patId => {
        edges.push({ from: supNode.id, to: patId, color: '#047fe4' });
      });
      supIndex++;
    }
    orgIndex++;
  });
});

// Build id → node map
const nodeMap = {};
nodes.forEach(n => { nodeMap[n.id] = n; });

// ── Canvas setup ──────────────────────────────────────────────────────────────
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function resize() {
  canvas.width = box.offsetWidth;
  canvas.height = box.offsetHeight;
}
resize();
window.addEventListener('resize', resize);

// ── Counters ──────────────────────────────────────────────────────────────────
document.getElementById('cnt-patterns').textContent = PATTERNS.length;
document.getElementById('cnt-suppliers').textContent = nodes.filter(n=>n.layer==='Supplier').length;
document.getElementById('cnt-orgs').textContent = nodes.filter(n=>n.layer==='Organisation').length;
document.getElementById('cnt-customers').textContent = CUSTOMERS.length;

// ── Animation state ───────────────────────────────────────────────────────────
let t = 0;
let hovered = null;

// Staggered reveal
const revealDelay = {
  'Match Pattern': 0,
  'Supplier': 60,
  'Organisation': 120,
  'Customer': 180,
};
nodes.forEach(n => { n.revealFrame = revealDelay[n.layer] + randInt(0, 40); n.alpha = 0; });

// ── Hex to rgb ─────────────────────────────────────────────────────────────────
function hexRgb(hex) {
  const r = parseInt(hex.slice(1,3),16);
  const g = parseInt(hex.slice(3,5),16);
  const b = parseInt(hex.slice(5,7),16);
  return {r,g,b};
}

// ── Draw ──────────────────────────────────────────────────────────────────────
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // No background fill — transparent

  // Subtle ring guides
  [R[1], R[2], R[3]].forEach((r, i) => {
    ctx.beginPath();
    ctx.arc(cx, cy, r, 0, Math.PI * 2);
    ctx.strokeStyle = `rgba(255,255,255,0.03)`;
    ctx.lineWidth = 1;
    ctx.stroke();
  });

  // Update node alphas
  nodes.forEach(n => {
    if (t >= n.revealFrame && n.alpha < 1) {
      n.alpha = Math.min(1, n.alpha + 0.03);
    }
  });

  // Draw edges
  edges.forEach(e => {
    const a = nodeMap[e.from];
    const b = nodeMap[e.to];
    if (!a || !b) return;
    const alpha = Math.min(a.alpha, b.alpha) * 0.12;
    if (alpha <= 0) return;
    const {r,g,b: bv} = hexRgb(e.color);
    ctx.beginPath();
    ctx.moveTo(a.x, a.y);
    ctx.lineTo(b.x, b.y);
    ctx.strokeStyle = `rgba(${r},${g},${bv},${alpha})`;
    ctx.lineWidth = 0.5;
    ctx.stroke();
  });

  // Highlight hovered edges
  if (hovered) {
    edges.forEach(e => {
      if (e.from !== hovered.id && e.to !== hovered.id) return;
      const a = nodeMap[e.from];
      const b = nodeMap[e.to];
      if (!a || !b) return;
      const {r,g,b: bv} = hexRgb(hovered.color || '#ffffff');
      ctx.beginPath();
      ctx.moveTo(a.x, a.y);
      ctx.lineTo(b.x, b.y);
      ctx.strokeStyle = `rgba(${r},${g},${bv},0.7)`;
      ctx.lineWidth = 1.2;
      ctx.stroke();
    });
  }

  // Draw nodes
  nodes.forEach(n => {
    if (n.alpha <= 0) return;
    const isHov = hovered && hovered.id === n.id;
    const pulse = isHov ? 1 + 0.3 * Math.sin(t * 0.15) : 1;
    const r = n.baseRadius * pulse;
    const {r: cr, g: cg, b: cb} = hexRgb(n.color);

    // Glow
    const glow = ctx.createRadialGradient(n.x, n.y, 0, n.x, n.y, r * 4);
    glow.addColorStop(0, `rgba(${cr},${cg},${cb},${n.alpha * (isHov ? 0.5 : 0.15)})`);
    glow.addColorStop(1, `rgba(${cr},${cg},${cb},0)`);
    ctx.beginPath();
    ctx.arc(n.x, n.y, r * 4, 0, Math.PI * 2);
    ctx.fillStyle = glow;
    ctx.fill();

    // Core dot
    ctx.beginPath();
    ctx.arc(n.x, n.y, r, 0, Math.PI * 2);
    ctx.fillStyle = `rgba(${cr},${cg},${cb},${n.alpha * (isHov ? 1 : 0.85)})`;
    ctx.fill();

    // Pattern nodes get a white ring
    if (n.layer === 'Match Pattern') {
      ctx.beginPath();
      ctx.arc(n.x, n.y, r + 2, 0, Math.PI * 2);
      ctx.strokeStyle = `rgba(255,255,255,${n.alpha * 0.4})`;
      ctx.lineWidth = 0.8;
      ctx.stroke();
    }

    // Label for hovered or large nodes
    if (isHov || (n.layer === 'Customer' && n.alpha > 0.8)) {
      ctx.font = isHov ? '600 12px Inter, sans-serif' : '400 10px ui-monospace, monospace';
      ctx.fillStyle = isHov ? `rgba(255,255,255,${n.alpha})` : `rgba(${cr},${cg},${cb},${n.alpha * 0.7})`;
      ctx.textAlign = 'center';
      ctx.fillText(n.layer === 'Customer' ? n.name : '', n.x, n.y - r - 8);
    }
  });

  t++;
  requestAnimationFrame(draw);
}

// ── Mouse interaction ─────────────────────────────────────────────────────────
canvas.addEventListener('mousemove', e => {
  const mx = e.clientX, my = e.clientY;
  let closest = null, closestDist = 20;
  nodes.forEach(n => {
    if (n.alpha < 0.5) return;
    const d = Math.hypot(n.x - mx, n.y - my);
    if (d < closestDist) { closestDist = d; closest = n; }
  });
  hovered = closest;

  const tt = document.getElementById('tooltip');
  if (closest) {
    document.getElementById('tt-layer').textContent = closest.layer;
    document.getElementById('tt-name').textContent = closest.name;
    tt.style.opacity = '1';
    tt.style.left = (mx + 16) + 'px';
    tt.style.top = (my - 10) + 'px';
  } else {
    tt.style.opacity = '0';
  }
});

canvas.addEventListener('mouseleave', () => {
  hovered = null;
  document.getElementById('tooltip').style.opacity = '0';
});

draw();
}); // end DOMContentLoaded
</script>
</body>
</html>
